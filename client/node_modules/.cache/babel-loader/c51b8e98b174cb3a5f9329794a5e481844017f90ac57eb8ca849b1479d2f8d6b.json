{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\emil\\\\OneDrive\\\\Documents\\\\development\\\\apiDevelopment\\\\pubg-tournament-tracker\\\\client\\\\src\\\\contexts\\\\AuthContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport jwt_decode from 'jwt-decode';\nimport api from '../services/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext();\nexport const useAuth = () => {\n  _s();\n  return useContext(AuthContext);\n};\n_s(useAuth, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nexport const AuthProvider = ({\n  children\n}) => {\n  _s2();\n  const [currentUser, setCurrentUser] = useState(null);\n  const [token, setToken] = useState(localStorage.getItem('token'));\n  const [loading, setLoading] = useState(true);\n  const navigate = useNavigate();\n  useEffect(() => {\n    const verifyToken = async () => {\n      if (!token) {\n        setCurrentUser(null);\n        setLoading(false);\n        return;\n      }\n      try {\n        // Check if token is expired\n        const decoded = jwt_decode(token);\n        const currentTime = Date.now() / 1000;\n        if (decoded.exp < currentTime) {\n          // Token is expired\n          logout();\n          return;\n        }\n\n        // Set auth header\n        api.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n\n        // Get current user\n        const response = await api.get('/auth/me');\n        setCurrentUser(response.data.user);\n      } catch (error) {\n        console.error('Error verifying token:', error);\n        logout();\n      } finally {\n        setLoading(false);\n      }\n    };\n    verifyToken();\n  }, [token]);\n  const login = async (usernameOrEmail, password) => {\n    try {\n      const response = await api.post('/auth/login', {\n        usernameOrEmail,\n        password\n      });\n      const {\n        token,\n        user\n      } = response.data;\n\n      // Save token to localStorage\n      localStorage.setItem('token', token);\n\n      // Set auth header\n      api.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n      setToken(token);\n      setCurrentUser(user);\n      return user;\n    } catch (error) {\n      var _error$response;\n      console.error('Login error:', ((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.data) || error.message);\n      throw error;\n    }\n  };\n  const register = async userData => {\n    try {\n      const response = await api.post('/auth/register', userData);\n      const {\n        token,\n        user\n      } = response.data;\n\n      // Save token to localStorage\n      localStorage.setItem('token', token);\n\n      // Set auth header\n      api.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n      setToken(token);\n      setCurrentUser(user);\n      return user;\n    } catch (error) {\n      var _error$response2;\n      console.error('Registration error:', ((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.data) || error.message);\n      throw error;\n    }\n  };\n  const logout = () => {\n    // Remove token from localStorage\n    localStorage.removeItem('token');\n\n    // Remove auth header\n    delete api.defaults.headers.common['Authorization'];\n    setToken(null);\n    setCurrentUser(null);\n\n    // Redirect to login\n    navigate('/login');\n  };\n  const refreshToken = async () => {\n    try {\n      const response = await api.post('/auth/refresh', {\n        token\n      });\n      const newToken = response.data.token;\n\n      // Save token to localStorage\n      localStorage.setItem('token', newToken);\n\n      // Set auth header\n      api.defaults.headers.common['Authorization'] = `Bearer ${newToken}`;\n      setToken(newToken);\n      return newToken;\n    } catch (error) {\n      var _error$response3;\n      console.error('Token refresh error:', ((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : _error$response3.data) || error.message);\n      logout();\n      throw error;\n    }\n  };\n  const value = {\n    currentUser,\n    loading,\n    login,\n    register,\n    logout,\n    refreshToken,\n    isAuthenticated: !!currentUser\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 146,\n    columnNumber: 5\n  }, this);\n};\n_s2(AuthProvider, \"7ntKewu/W1dj0pLD0tZ/2ona6m8=\", false, function () {\n  return [useNavigate];\n});\n_c = AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","useNavigate","jwt_decode","api","jsxDEV","_jsxDEV","AuthContext","useAuth","_s","AuthProvider","children","_s2","currentUser","setCurrentUser","token","setToken","localStorage","getItem","loading","setLoading","navigate","verifyToken","decoded","currentTime","Date","now","exp","logout","defaults","headers","common","response","get","data","user","error","console","login","usernameOrEmail","password","post","setItem","_error$response","message","register","userData","_error$response2","removeItem","refreshToken","newToken","_error$response3","value","isAuthenticated","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/emil/OneDrive/Documents/development/apiDevelopment/pubg-tournament-tracker/client/src/contexts/AuthContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport jwt_decode from 'jwt-decode';\nimport api from '../services/api';\n\nconst AuthContext = createContext();\n\nexport const useAuth = () => useContext(AuthContext);\n\nexport const AuthProvider = ({ children }) => {\n  const [currentUser, setCurrentUser] = useState(null);\n  const [token, setToken] = useState(localStorage.getItem('token'));\n  const [loading, setLoading] = useState(true);\n  const navigate = useNavigate();\n  \n  useEffect(() => {\n    const verifyToken = async () => {\n      if (!token) {\n        setCurrentUser(null);\n        setLoading(false);\n        return;\n      }\n      \n      try {\n        // Check if token is expired\n        const decoded = jwt_decode(token);\n        const currentTime = Date.now() / 1000;\n        \n        if (decoded.exp < currentTime) {\n          // Token is expired\n          logout();\n          return;\n        }\n        \n        // Set auth header\n        api.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n        \n        // Get current user\n        const response = await api.get('/auth/me');\n        setCurrentUser(response.data.user);\n      } catch (error) {\n        console.error('Error verifying token:', error);\n        logout();\n      } finally {\n        setLoading(false);\n      }\n    };\n    \n    verifyToken();\n  }, [token]);\n  \n  const login = async (usernameOrEmail, password) => {\n    try {\n      const response = await api.post('/auth/login', {\n        usernameOrEmail,\n        password\n      });\n      \n      const { token, user } = response.data;\n      \n      // Save token to localStorage\n      localStorage.setItem('token', token);\n      \n      // Set auth header\n      api.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n      \n      setToken(token);\n      setCurrentUser(user);\n      \n      return user;\n    } catch (error) {\n      console.error('Login error:', error.response?.data || error.message);\n      throw error;\n    }\n  };\n  \n  const register = async (userData) => {\n    try {\n      const response = await api.post('/auth/register', userData);\n      \n      const { token, user } = response.data;\n      \n      // Save token to localStorage\n      localStorage.setItem('token', token);\n      \n      // Set auth header\n      api.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n      \n      setToken(token);\n      setCurrentUser(user);\n      \n      return user;\n    } catch (error) {\n      console.error('Registration error:', error.response?.data || error.message);\n      throw error;\n    }\n  };\n  \n  const logout = () => {\n    // Remove token from localStorage\n    localStorage.removeItem('token');\n    \n    // Remove auth header\n    delete api.defaults.headers.common['Authorization'];\n    \n    setToken(null);\n    setCurrentUser(null);\n    \n    // Redirect to login\n    navigate('/login');\n  };\n  \n  const refreshToken = async () => {\n    try {\n      const response = await api.post('/auth/refresh', { token });\n      \n      const newToken = response.data.token;\n      \n      // Save token to localStorage\n      localStorage.setItem('token', newToken);\n      \n      // Set auth header\n      api.defaults.headers.common['Authorization'] = `Bearer ${newToken}`;\n      \n      setToken(newToken);\n      \n      return newToken;\n    } catch (error) {\n      console.error('Token refresh error:', error.response?.data || error.message);\n      logout();\n      throw error;\n    }\n  };\n  \n  const value = {\n    currentUser,\n    loading,\n    login,\n    register,\n    logout,\n    refreshToken,\n    isAuthenticated: !!currentUser\n  };\n  \n  return (\n    <AuthContext.Provider value={value}>\n      {children}\n    </AuthContext.Provider>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}